{"ast":null,"code":"import _slicedToArray from\"D:/Projects/Alexandria/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useEffect}from'react';import Axios from'axios';import{withRouter}from'react-router-dom';import{BeatLoader}from'react-spinners';import{toast}from'react-toastify';import{CheckmarkIcon}from'./partial/icons';import{app}from'../firebase/index';import'../css/books.css';import'react-toastify/dist/ReactToastify.css';function Book(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),book=_useState2[0],setBook=_useState2[1];var title=props.match.params.title;var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),imageUrl=_useState6[0],setImageUrl=_useState6[1];toast.configure();useEffect(function(){var mounted=true;Axios.get(\"http://localhost:8000/api/books/get/\".concat(title),{withCredentials:true}).then(function(res){if(mounted){setBook(res.data);var storageRef=app.storage().ref();storageRef.child(\"\".concat(res.data.image)).getDownloadURL().then(function(url){setImageUrl(url);setLoading(false);});}}).catch(function(){return props.history.push('/error');});return function(){mounted=false;};},[title,props.history]);var addToBasket=function addToBasket(id){Axios.get(\"http://localhost:8000/api/basket/add/\".concat(id),{withCredentials:true}).then(function(){toast.info(\"Book added to basket!\",{position:toast.POSITION.BOTTOM_RIGHT,pauseOnHover:false,autoClose:2000});});};var availability=book.available?/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-in-stock\",children:[/*#__PURE__*/_jsx(CheckmarkIcon,{width:\"20\",height:\"20\"}),\"In stock\"]}):/*#__PURE__*/_jsx(\"p\",{className:\"single-book-out-of-stock\",children:\"Out of stock\"});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(BeatLoader,{loading:true})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"single-book-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"single-book-image\",children:/*#__PURE__*/_jsx(\"img\",{src:imageUrl,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"single-book-info\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"single-book-title\",children:book.title}),/*#__PURE__*/_jsxs(\"h2\",{className:\"single-book-author\",children:[\"by \",book.author]}),/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-genre\",children:[\"Genre: \",book.genre]}),/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-date\",style:{display:book.publishedDate===''?'none':''},children:[\"Published: \",book.publishedDate]}),/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-price\",children:[\"$\",book.price]}),availability,/*#__PURE__*/_jsx(\"button\",{className:\"single-book-add-to-basket\",onClick:function onClick(){addToBasket(book._id);},style:{display:book.available?'':'none'},children:\"Add to basket\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"single-book-description\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{display:book.description===''?'none':''},children:\"Description\"}),book.description]})]})]});}export default withRouter(Book);","map":{"version":3,"sources":["D:/Projects/Alexandria/client/src/components/book.jsx"],"names":["React","useState","useEffect","Axios","withRouter","BeatLoader","toast","CheckmarkIcon","app","Book","props","book","setBook","title","match","params","loading","setLoading","imageUrl","setImageUrl","configure","mounted","get","withCredentials","then","res","data","storageRef","storage","ref","child","image","getDownloadURL","url","catch","history","push","addToBasket","id","info","position","POSITION","BOTTOM_RIGHT","pauseOnHover","autoClose","availability","available","author","genre","display","publishedDate","price","_id","description"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport Axios from 'axios';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {BeatLoader} from 'react-spinners';\r\nimport {toast} from 'react-toastify';\r\nimport {CheckmarkIcon} from './partial/icons';\r\nimport {app} from '../firebase/index';\r\nimport '../css/books.css';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nfunction Book(props){\r\n    const [book, setBook] = useState({});\r\n    const {title} = props.match.params;\r\n    const [loading, setLoading] = useState(true);\r\n    const [imageUrl, setImageUrl] = useState('');\r\n    toast.configure();\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n\r\n        Axios.get(`http://localhost:8000/api/books/get/${title}`, {withCredentials: true})\r\n        .then(res => {\r\n            if(mounted){\r\n                setBook(res.data);  \r\n                const storageRef = app.storage().ref();\r\n                storageRef.child(`${res.data.image}`).getDownloadURL()\r\n                .then(url => {\r\n                        setImageUrl(url);\r\n                        setLoading(false);\r\n                    }\r\n                );\r\n            }       \r\n        })\r\n        .catch(() => props.history.push('/error'));\r\n\r\n        return () => {\r\n            mounted = false;\r\n        }\r\n    }, [title, props.history]);\r\n\r\n    const addToBasket = (id) => {\r\n        Axios.get(`http://localhost:8000/api/basket/add/${id}`, {withCredentials: true})\r\n        .then(() => {toast.info(\"Book added to basket!\", {position: toast.POSITION.BOTTOM_RIGHT, pauseOnHover: false, autoClose: 2000})});\r\n    };\r\n\r\n    const availability = book.available ?\r\n    <p className=\"single-book-in-stock\"><CheckmarkIcon width=\"20\" height=\"20\"/>In stock</p> \r\n    : <p className=\"single-book-out-of-stock\">Out of stock</p>;\r\n\r\n    if(loading){\r\n        return <div className=\"loading-container\"><BeatLoader loading/></div>;\r\n    }\r\n    \r\n    return (\r\n        <div className=\"single-book-container\">\r\n            <div className=\"single-book-image\">\r\n                <img src={imageUrl} alt=\"\"/>\r\n            </div>\r\n            <div className=\"single-book-info\">\r\n                <h1 className=\"single-book-title\">{book.title}</h1>\r\n                <h2 className=\"single-book-author\">by {book.author}</h2>\r\n                <p className=\"single-book-genre\">Genre: {book.genre}</p>\r\n                <p className=\"single-book-date\" style={{display: book.publishedDate === '' ? 'none' : ''}}>Published: {book.publishedDate}</p>\r\n                <p className=\"single-book-price\">${book.price}</p>\r\n                {availability}\r\n                <button className=\"single-book-add-to-basket\" onClick={() => {addToBasket(book._id)}}\r\n                style={{display: book.available ? '' : 'none'}}>\r\n                    Add to basket\r\n                </button>\r\n                <div className=\"single-book-description\">\r\n                    <h1 style={{display: book.description === '' ? 'none' : ''}}>Description</h1> \r\n                    {book.description}\r\n                </div>\r\n            </div> \r\n        </div>\r\n    );\r\n}\r\n\r\nexport default withRouter(Book);"]},"metadata":{},"sourceType":"module"}