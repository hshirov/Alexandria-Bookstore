{"ast":null,"code":"import _slicedToArray from\"D:/Projects/Alexandria/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from'react';import Axios from'axios';import{BeatLoader}from'react-spinners';import{toast}from'react-toastify';import BasketItem from'./partial/basketItem';import'../css/basket.css';function Basket(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),items=_useState2[0],setItems=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),totalPrice=_useState4[0],setTotalPrice=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),isBasketEmpty=_useState6[0],setisBasketEmpty=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];toast.configure();useEffect(function(){var mounted=true;Axios.get('http://localhost:8000/api/basket/getItems',{withCredentials:true}).then(function(res){if(mounted){if(res.data==='emptyBasket'){setisBasketEmpty(true);}else{setisBasketEmpty(false);var requestedItems=res.data;setItems(requestedItems.array);setTotalPrice(requestedItems.totalPrice);}setLoading(false);}}).catch(function(){return props.history.push('/error');});return function(){mounted=false;};},[props.history]);var clearBasket=function clearBasket(){Axios.get('http://localhost:8000/api/basket/clear',{withCredentials:true}).then(function(){toast.info(\"Basket cleared!\",{position:toast.POSITION.BOTTOM_RIGHT,pauseOnHover:false,autoClose:2000});setisBasketEmpty(true);});};var removeItem=function removeItem(id){Axios.get(\"http://localhost:8000/api/basket/remove/\".concat(id),{withCredentials:true}).then(function(){window.location.reload();});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(BeatLoader,{loading:true})});}if(isBasketEmpty){return/*#__PURE__*/_jsx(\"div\",{className:\"basket-empty-container\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Your basket is empty. Go do some shopping.\"})});}var itemList=items.map(function(book){return/*#__PURE__*/_jsx(BasketItem,{book:book,removeItem:removeItem},book.item.title);});return/*#__PURE__*/_jsxs(\"div\",{className:\"basket-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"basket-items-container\",children:itemList}),/*#__PURE__*/_jsxs(\"div\",{className:\"basket-info\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Total: $\",totalPrice]}),/*#__PURE__*/_jsx(\"button\",{onClick:clearBasket,children:\"Clear basket\"})]})]});}export default Basket;","map":{"version":3,"sources":["D:/Projects/Alexandria/client/src/components/basket.jsx"],"names":["React","useState","useEffect","Axios","BeatLoader","toast","BasketItem","Basket","props","items","setItems","totalPrice","setTotalPrice","isBasketEmpty","setisBasketEmpty","loading","setLoading","configure","mounted","get","withCredentials","then","res","data","requestedItems","array","catch","history","push","clearBasket","info","position","POSITION","BOTTOM_RIGHT","pauseOnHover","autoClose","removeItem","id","window","location","reload","itemList","map","book","item","title"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport Axios from 'axios';\r\nimport {BeatLoader} from 'react-spinners';\r\nimport {toast} from 'react-toastify';\r\nimport BasketItem from './partial/basketItem';\r\nimport '../css/basket.css';\r\n\r\nfunction Basket(props){\r\n    const [items, setItems] = useState([]);\r\n    const [totalPrice, setTotalPrice] = useState(0);\r\n    const [isBasketEmpty, setisBasketEmpty] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    toast.configure();\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n\r\n        Axios.get('http://localhost:8000/api/basket/getItems', {withCredentials: true})\r\n        .then(res => {\r\n            if(mounted){\r\n                if(res.data === 'emptyBasket'){\r\n                    setisBasketEmpty(true);\r\n                }else{\r\n                    setisBasketEmpty(false);\r\n                    const requestedItems = res.data;\r\n                    setItems(requestedItems.array);\r\n                    setTotalPrice(requestedItems.totalPrice);\r\n                }\r\n                setLoading(false);\r\n            }\r\n        })\r\n        .catch(() => props.history.push('/error'));\r\n\r\n        return () => {\r\n            mounted = false;\r\n        }\r\n    }, [props.history]);\r\n\r\n    const clearBasket = () => {\r\n        Axios.get('http://localhost:8000/api/basket/clear', {withCredentials: true})\r\n        .then(() => {\r\n            toast.info(\"Basket cleared!\", {position: toast.POSITION.BOTTOM_RIGHT, pauseOnHover: false, autoClose: 2000});\r\n            setisBasketEmpty(true);\r\n        });\r\n    }\r\n\r\n    const removeItem = (id) => {\r\n        Axios.get(`http://localhost:8000/api/basket/remove/${id}`, {withCredentials: true})\r\n        .then(() => {\r\n            window.location.reload();\r\n        });\r\n    }\r\n\r\n    if(loading){\r\n        return <div className=\"loading-container\"><BeatLoader loading/></div>;\r\n    }\r\n\r\n    if(isBasketEmpty){\r\n        return(\r\n            <div className=\"basket-empty-container\">\r\n                <h1>Your basket is empty. Go do some shopping.</h1>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const itemList = items.map(book => {\r\n        return(\r\n            <BasketItem book={book} removeItem={removeItem} key={book.item.title} />\r\n        );\r\n    });\r\n\r\n    return (\r\n        <div className=\"basket-container\">\r\n            <div className=\"basket-items-container\">\r\n                {itemList}\r\n            </div>\r\n            <div className=\"basket-info\">\r\n                <h2>Total: ${totalPrice}</h2>\r\n                <button onClick={clearBasket}>Clear basket</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Basket;"]},"metadata":{},"sourceType":"module"}