{"ast":null,"code":"import _slicedToArray from\"D:/Projects/Alexandria/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from'react';import Axios from'axios';import{withRouter}from'react-router-dom';import{BeatLoader}from'react-spinners';import{app}from'../../firebase/index';import'react-toastify/dist/ReactToastify.css';function Book(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),book=_useState2[0],setBook=_useState2[1];var title=props.match.params.title;var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),imageUrl=_useState6[0],setImageUrl=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),available=_useState8[0],setAvailable=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),featured=_useState10[0],setFeatured=_useState10[1];useEffect(function(){var mounted=true;Axios.get(\"http://localhost:8000/api/books/get/\".concat(title),{withCredentials:true}).then(function(res){if(mounted){setBook(res.data);var storageRef=app.storage().ref();storageRef.child(\"\".concat(res.data.image)).getDownloadURL().then(function(url){setImageUrl(url);setAvailable(res.data.available);setFeatured(res.data.featured);setLoading(false);});}}).catch(function(){return props.history.push('/error');});return function(){mounted=false;};},[title,props.history]);var updateAvailability=function updateAvailability(){Axios.post('http://localhost:8000/api/admin/update',{id:book._id,field:'available',value:!available},{withCredentials:true}).catch(function(){return props.history.push('/error');});window.location.reload();};var updateFeatured=function updateFeatured(){Axios.post('http://localhost:8000/api/admin/update',{id:book._id,field:'featured',value:!featured},{withCredentials:true}).catch(function(){return props.history.push('/error');});window.location.reload();};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(BeatLoader,{loading:true})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return props.history.push('/admin/books');},children:\"Back to books\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"single-book-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"single-book-image\",children:/*#__PURE__*/_jsx(\"img\",{src:imageUrl,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"single-book-info\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"single-book-title\",children:book.title}),/*#__PURE__*/_jsxs(\"h2\",{className:\"single-book-author\",children:[\"by \",book.author]}),/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-genre\",children:[\"Genre: \",book.genre]}),/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-date\",style:{display:book.publishedDate===''?'none':''},children:[\"Published: \",book.publishedDate]}),/*#__PURE__*/_jsxs(\"p\",{className:\"single-book-price\",children:[\"$\",book.price]}),/*#__PURE__*/_jsx(\"button\",{onClick:updateAvailability,children:/*#__PURE__*/_jsxs(\"div\",{className:\"availability-selector\",children:[/*#__PURE__*/_jsx(\"div\",{className:available?\"selected-outline\":\"\",children:/*#__PURE__*/_jsx(\"p\",{className:\"single-book-in-stock\",children:\"In stock\"})}),/*#__PURE__*/_jsx(\"div\",{className:!available?\"selected-outline\":\"\",children:/*#__PURE__*/_jsx(\"p\",{className:\"single-book-out-of-stock\",children:\"Out of stock\"})})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"button\",{onClick:updateFeatured,children:[featured?'Remove from ':'Feature on ',\"home page\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"single-book-description\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{display:book.description===''?'none':''},children:\"Description\"}),book.description]})]})]})]});}export default withRouter(Book);","map":{"version":3,"sources":["D:/Projects/Alexandria/client/src/components/admin/book.jsx"],"names":["React","useState","useEffect","Axios","withRouter","BeatLoader","app","Book","props","book","setBook","title","match","params","loading","setLoading","imageUrl","setImageUrl","available","setAvailable","featured","setFeatured","mounted","get","withCredentials","then","res","data","storageRef","storage","ref","child","image","getDownloadURL","url","catch","history","push","updateAvailability","post","id","_id","field","value","window","location","reload","updateFeatured","author","genre","display","publishedDate","price","description"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport Axios from 'axios';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {BeatLoader} from 'react-spinners';\r\nimport {app} from '../../firebase/index';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nfunction Book(props){\r\n    const [book, setBook] = useState({});\r\n    const {title} = props.match.params;\r\n    const [loading, setLoading] = useState(true);\r\n    const [imageUrl, setImageUrl] = useState('');\r\n    const [available, setAvailable] = useState(null);\r\n    const [featured, setFeatured] = useState(null);\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n\r\n        Axios.get(`http://localhost:8000/api/books/get/${title}`, {withCredentials: true})\r\n        .then(res => {\r\n            if(mounted){\r\n                setBook(res.data);       \r\n                const storageRef = app.storage().ref();\r\n                storageRef.child(`${res.data.image}`).getDownloadURL()\r\n                .then((url) => {\r\n                        setImageUrl(url);\r\n                        setAvailable(res.data.available);\r\n                        setFeatured(res.data.featured);\r\n                        setLoading(false);\r\n                    }\r\n                );\r\n            }\r\n        })\r\n        .catch(() => props.history.push('/error'));\r\n\r\n        return () => {\r\n            mounted = false;\r\n        }\r\n    }, [title, props.history]);\r\n\r\n    const updateAvailability = () => {\r\n        Axios.post('http://localhost:8000/api/admin/update', {id: book._id, field: 'available', value: !available}, {withCredentials: true})\r\n        .catch(() => props.history.push('/error'));\r\n        window.location.reload();\r\n    }\r\n\r\n    const updateFeatured = () => {\r\n        Axios.post('http://localhost:8000/api/admin/update', {id: book._id, field: 'featured', value: !featured}, {withCredentials: true})\r\n        .catch(() => props.history.push('/error'));\r\n        window.location.reload();\r\n    }\r\n\r\n    if(loading){\r\n        return <div className=\"loading-container\"><BeatLoader loading/></div>;\r\n    }\r\n    \r\n    return (\r\n        <div>\r\n            <button onClick={() => props.history.push('/admin/books')}>Back to books</button>\r\n            <div className=\"single-book-container\">\r\n                <div className=\"single-book-image\">\r\n                    <img src={imageUrl} alt=\"\"/>\r\n                </div>\r\n                <div className=\"single-book-info\">\r\n                    <h1 className=\"single-book-title\">{book.title}</h1>\r\n                    <h2 className=\"single-book-author\">by {book.author}</h2>\r\n                    <p className=\"single-book-genre\">Genre: {book.genre}</p>\r\n                    <p className=\"single-book-date\" style={{display: book.publishedDate === '' ? 'none' : ''}}>Published: {book.publishedDate}</p>\r\n                    <p className=\"single-book-price\">${book.price}</p>\r\n                    <button onClick={updateAvailability}>\r\n                        <div className=\"availability-selector\">\r\n                            <div className={available ? \"selected-outline\" : \"\"}>\r\n                                <p className=\"single-book-in-stock\">In stock</p>\r\n                            </div>\r\n                            <div className={!available ? \"selected-outline\" : \"\"}>\r\n                                <p className=\"single-book-out-of-stock\">Out of stock</p>\r\n                            </div>\r\n                        </div>\r\n                    </button><br />\r\n                    <button onClick={updateFeatured}>{featured ? 'Remove from ' : 'Feature on '}home page</button>\r\n                    <div className=\"single-book-description\">\r\n                        <h1 style={{display: book.description === '' ? 'none' : ''}}>Description</h1> \r\n                        {book.description}\r\n                    </div>\r\n                </div> \r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default withRouter(Book);"]},"metadata":{},"sourceType":"module"}